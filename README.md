half of this code isnt chatgpt trust
